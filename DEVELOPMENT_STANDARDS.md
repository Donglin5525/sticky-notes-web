# 工作便签 TodoList - 开发规范

## 核心原则

### 1. 双端适配（PC + 移动端）

**每次需求和改进点必须同时适配两个界面：**

#### PC 端（桌面）
- 左侧边栏导航（宽度 256px）
- 多栏布局展示
- 鼠标交互（右键菜单、悬停效果）
- 完整功能可视化

#### 移动端（手机）
- 底部 Tab 导航（固定高度 56px）
- 单栏布局展示
- 触摸交互（长按、滑动）
- 响应式折叠/展开

**适配检查清单：**
- [ ] PC 端布局是否正确显示
- [ ] 移动端是否使用底部 Tab 导航
- [ ] 响应式断点是否正确（md: 768px）
- [ ] 触摸交互是否友好
- [ ] 文字大小是否在移动端可读
- [ ] 按钮/输入框大小是否满足移动端操作需求（最小 44px）

---

### 2. 更新日志管理

**自动维护更新日志，记录每个版本的变更：**

#### 日志位置
- 文件：`CHANGELOG.md`
- 格式：[Keep a Changelog](https://keepachangelog.com/) 标准

#### 日志结构
```markdown
# 更新日志

## [v1.5.0] - 2026-02-27

### 新增
- 标签树新增子标签功能
- 习惯排序功能（按最近打卡、打卡次数、创建时间）

### 修复
- 移动端趋势图坐标轴超出框问题
- 柱状图高度计算错误

### 改进
- 优化移动端 Tab 导航顺序
- 调整移动端首屏默认路由为打卡页面
```

#### 更新日志规范
- **新增（Added）**：新功能、新组件、新 API
- **修复（Fixed）**：bug 修复、问题解决
- **改进（Changed）**：功能优化、性能提升、交互改进
- **移除（Removed）**：删除的功能或组件
- **弃用（Deprecated）**：即将删除的功能

#### 自动更新流程
1. 每次 `webdev_save_checkpoint` 前，更新 `CHANGELOG.md`
2. 在 `todo.md` 中标记完成的任务时，同步添加到更新日志
3. 版本号遵循 [Semantic Versioning](https://semver.org/)：MAJOR.MINOR.PATCH

---

### 3. 需求处理流程

**每次处理用户需求时的标准流程：**

1. **更新 todo.md**
   - 使用 `[ ]` 标记新需求
   - 分类整理（功能、修复、改进）

2. **PC + 移动端双端实现**
   - PC 端：使用左侧边栏导航、右键菜单、完整布局
   - 移动端：使用底部 Tab 导航、触摸交互、响应式折叠

3. **完成后更新日志**
   - 在 `CHANGELOG.md` 中记录变更
   - 标记 todo.md 中的任务为 `[x]`

4. **保存检查点**
   - 运行 `pnpm test` 确保测试通过
   - 调用 `webdev_save_checkpoint`

---

## 项目特定规范

### 三大功能模块

#### 便签笔记（Notes）
- PC 端：左侧列表 + 右侧编辑器
- 移动端：全屏编辑，底部 Tab 切换
- 标签树支持：新增、重命名、删除、移动

#### 待办清单（Daily Todo）
- PC 端：四象限网格展示
- 移动端：单列展示，可折叠象限
- 底部 Tab：待办

#### 习惯打卡（Habit Tracker）
- PC 端：习惯列表 + 统计面板
- 移动端：卡片列表，底部 Tab 首屏
- 数据可视化：热力图、趋势图、统计面板

### 移动端导航顺序（底部 Tab）
```
1. 打卡（/habits）- 首屏默认
2. 代办（/todo）
3. 便签（/）
```

### 响应式断点
- 移动端：< 768px（md）
- 桌面端：≥ 768px（md）

---

## 检查清单

### 功能完成检查
- [ ] PC 端功能完整可用
- [ ] 移动端功能完整可用
- [ ] 所有测试通过（`pnpm test`）
- [ ] TypeScript 编译无错误
- [ ] 更新日志已记录
- [ ] todo.md 已更新

### 代码质量检查
- [ ] 没有 console.log 或调试代码
- [ ] 错误处理完善
- [ ] 性能优化（避免无限循环、过度渲染）
- [ ] 可访问性考虑（ARIA 标签、键盘导航）

---

## 常见问题

### Q: 如何处理 PC 端和移动端差异很大的功能？
**A:** 使用 `useIsMobile()` hook 或 Tailwind 的响应式类（`hidden md:block` 等）来条件渲染。避免完全不同的实现，保持代码可维护性。

### Q: 更新日志应该多细致？
**A:** 记录用户可感知的变化。内部重构、依赖更新等不需要记录，除非影响功能或性能。

### Q: 如何处理紧急 bug 修复？
**A:** 即使是紧急修复，也要：1) 更新 todo.md；2) 修复 bug；3) 更新 CHANGELOG.md；4) 保存检查点。不能跳过任何步骤。

---

## 版本历史

| 版本 | 日期 | 主要内容 |
|------|------|--------|
| v1.5.0 | 2026-02-27 | 标签新增、习惯排序、移动端优化 |
| v1.4.0 | 2026-02-26 | 趋势图修复、全局排序功能 |
| v1.3.0 | 2026-02-25 | 移动端 Tab 顺序调整、默认路由 |
| v1.0.0 | 2026-02-01 | 初始版本发布 |
